<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US" xml:lang="en-US">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Phillip Alday" />
  <meta name="author" content="Dave Kleinschmidt" />
  <meta name="author" content="Reinhold Kliegl" />
  <meta name="author" content="Douglas Bates" />
  <title>Examining the Random Effects and Predictions - Embrace Uncertainty</title>
  <link rel="shortcut icon" type="image/png" href="/favicon.png"/>
  <link rel="stylesheet" href="/style.css"/>
    <script src="/mousetrap.min.js"></script>
    <!-- TODO: Add url_prefix. -->
  <style>
  @font-face {
    font-family: JuliaMono-Regular;
    src: url("/JuliaMono-Regular.woff2");
  }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
  <link rel="stylesheet" href="/github.min.css">
<script src="/highlight.min.js"></script>
<script src="/julia.min.js"></script>
<script>
document.addEventListener('DOMContentLoaded', (event) => {
    document.querySelectorAll('pre').forEach((el) => {
        hljs.highlightElement(el);
    });
});
</script>
 
</head>
<body>
<script>
function click_next() {
  var next = document.getElementById('nav-next');
  next.firstElementChild.nextElementSibling.click();
}
function click_prev() {
  var prev = document.getElementById('nav-prev');
  prev.firstElementChild.click();
}
Mousetrap.bind('right', click_next);
Mousetrap.bind('h', click_prev);
Mousetrap.bind('left', click_prev);
Mousetrap.bind('l', click_next);
</script>

<div class="books-container">
<aside class="books-menu">
<input type="checkbox" id="menu">
<label for="menu">☰</label>
<div class="books-title">
<a href="/">Embrace Uncertainty</a>
</div><br />
<span class="books-subtitle">
Fitting Mixed-Effects Models with Julia
</span>
<div class="books-menu-content">
<li><a class="menu-level-1" href="/ExamLMM"><b>1</b> A Simple, Linear, Mixed-..</a></li>
<li><a class="menu-level-2" href="/memod"><b>1.1</b> Mixed-effects models</a></li>
<li><a class="menu-level-2" href="/DyestuffData"><b>1.2</b> The dyestuff and dyest..</a></li>
<li><a class="menu-level-2" href="/FittingLMMs"><b>1.3</b> Fitting linear mixed m..</a></li>
<li><a class="menu-level-2" href="/Probability"><b>1.4</b> The linear mixed-effec..</a></li>
<li><a class="menu-level-2" href="/variability"><b>1.5</b> Assessing the variabil..</a></li>
<li><a class="menu-level-2" href="/assessRE"><b>1.6</b> Assessing the random e..</a></li>
<li><a class="menu-level-2" href="/ChIntroSummary"><b>1.7</b> Chapter summary</a></li>
<li><a class="menu-level-1" href="/Multiple"><b>2</b> Models With Multiple Ran..</a></li>
<li><a class="menu-level-2" href="/crossedRE"><b>2.1</b> A Model With Crossed R..</a></li>
<li><a class="menu-level-2" href="/NestedRE"><b>2.2</b> A Model With Nested Ra..</a></li>
<li><a class="menu-level-2" href="/partially"><b>2.3</b> A Model With Partially..</a></li>
<li><a class="menu-level-2" href="/MultSummary"><b>2.4</b> Chapter Summary</a></li>
<li><a class="menu-level-1" href="/longitudinal"><b>3</b> # Models for Longitudina..</a></li>
<li><a class="menu-level-2" href="/sleep"><b>3.1</b> Data</a></li>
<li><a class="menu-level-2" href="/SleepMixed"><b>3.2</b> Data</a></li>
<li><a class="menu-level-2" href="/assess-prec-param"><b>3.3</b> Assessing the Precisio..</a></li>
<li><a class="menu-level-2" href="/fm07re"><b>3.4</b> Examining the Random E..</a></li>
<li><a class="menu-level-2" href="/chapter-summary"><b>3.5</b> Chapter Summary</a></li>
<li><a class="menu-level-1" href="/computational"><b>4</b> Computational Methods fo..</a></li>
<li><a class="menu-level-2" href="/defnLMM"><b>4.1</b> Definitions and Basic ..</a></li>
<li><a class="menu-level-2" href="/conddistUgivenY"><b>4.2</b> </a></li>
<li><a class="menu-level-2" href="/IntegratingH"><b>4.3</b> in the Linear Mixed Mo..</a></li>
<li><a class="menu-level-2" href="/PLSsol"><b>4.4</b> </a></li>
<li><a class="menu-level-2" href="/REML"><b>4.5</b> The REML Criterion</a></li>
<li><a class="menu-level-2" href="/stepByStep"><b>4.6</b> Step-by-step Evaluatio..</a></li>
<li><a class="menu-level-2" href="/general"><b>4.7</b> Generalizing to Other ..</a></li>
<li><a class="menu-level-2" href="/lmmsummary"><b>4.8</b> Chapter Summary</a></li>
<li><a class="menu-level-1" href="/GLMMbinomial"><b>5</b> Generalized Linear Mixed..</a></li>
<li><a class="menu-level-2" href="/contraception"><b>5.1</b> Artificial contracepti..</a></li>
<li><a class="menu-level-2" href="/GLMMlink"><b>5.2</b> Link functions and int..</a></li>
<li><a class="menu-level-1" href="/references"><b></b> References</a></li>
</div>
</aside>

<div class="books-content">
<h2 data-number="3.4" id="sec:fm07re"><span class="header-section-number">3.4</span> Examining the Random Effects and Predictions</h2>
<p>The result of applying to fitted linear mixed model is a list of data frames. The components of the list correspond to the grouping factors in the random-effects terms, not to the terms themselves. Model <code>m11</code> is the first model we have fit with more than one term for the same grouping factor where we can see the combination of random effects from more than one term.</p>
<p>The method for objects produces one plot for each grouping factor. For scalar random effects the plot is a normal probability plot. For two-dimensional random effects, including the case of two scalar terms for the same grouping factor, as in this model, the plot is a scatterplot. For three or more random effects per level of the grouping factor, the plot is a scatterplot matrix. The left hand panel in Fig. <a href="#fig:ranefcoeffm07" data-reference-type="ref" data-reference="fig:ranefcoeffm07">[fig:ranefcoeffm07]</a> was created with .</p>
<p>The method for a fitted model combines the fixed-effects estimates and the conditional modes of the random effects, whenever the column names of the random effects correspond to the names of coefficients. For model the fixed-effects coefficients are and and the columns of the random effects match these names. Thus we can calculate some kind of per-subject “estimates” of the slope and intercept and plot them, as in the right hand panel of Fig. <a href="#fig:ranefcoeffm07" data-reference-type="ref" data-reference="fig:ranefcoeffm07">[fig:ranefcoeffm07]</a>. By comparing the two panels in Fig. <a href="#fig:ranefcoeffm07" data-reference-type="ref" data-reference="fig:ranefcoeffm07">[fig:ranefcoeffm07]</a> we can see that the result of the method is simply the conditional modes of the random effects shifted by the coefficient estimates.</p>
<p>It is not entirely clear how we should interpret these values. They are a combination of parameter estimates with the modal values of random variables and, as such, are in a type of “no man’s land” in the probability model. (In the Bayesian approach <span class="citation" data-cites="box73:_bayes_infer_statis_analy">(<a href="/references#ref-box73:_bayes_infer_statis_analy" role="doc-biblioref">Box &amp; Tiao, 1973</a>)</span> to inference, however, both the parameters and the random effects are random variables and the interpretation of these values is straightforward.) Despite the difficulties of interpretation in the probability model, these values are of interest because they determine the fitted response for each subject.</p>
<p>Because responses for each individual are recorded on each of ten days we can determine the within-subject estimates of the slope and intercept (that is, the slope and intercept of each of the lines in <!-- @fig:sleepxyplot -->. In Fig. <a href="#fig:shrinkage" data-reference-type="ref" data-reference="fig:shrinkage">[fig:shrinkage]</a> we compare the within-subject least squares estimates to the per-subject slope and intercept calculated from model . We see that, in general, the per-subject slopes and intercepts from the mixed-effects model are closer to the population estimates than are the within-subject least squares estimates. This pattern is sometimes described as a <em>shrinkage</em> of coefficients toward the population values.</p>
<p>The term “shrinkage” may have negative connotations. John Tukey chose to characterize this process in terms of the estimates for individual subjects “borrowing strength” from each other. This is a fundamental difference in the models underlying mixed-effects models versus strictly fixed-effects models. In a mixed-effects model we assume that the levels of a grouping factor are a selection from a population and, as a result, can be expected to share characteristics to some degree. Consequently, the predictions from a mixed-effects model are attenuated relative to those from strictly fixed-effects models.</p>
<p>The predictions from model and from the within-subject least squares fits for each subject are shown in Fig. <a href="#fig:shrinkfit" data-reference-type="ref" data-reference="fig:shrinkfit">[fig:shrinkfit]</a>.</p>
<p>It may seem that the shrinkage from the per-subject estimates toward the population estimates depends only on how far the per-subject estimates (solid lines) are from the population estimates (dot-dashed lines). However, careful examination of this figure shows that there is more at work here than a simple shrinkage toward the population estimates proportional to the distance of the per-subject estimates from the population estimates.</p>
<p>It is true that the mixed model estimates for a particular subject are “between” the within-subject estimates and the population estimates, in the sense that the arrows in Fig. <a href="#fig:shrinkage" data-reference-type="ref" data-reference="fig:shrinkage">[fig:shrinkage]</a> all point somewhat in the direction of the population estimate. However, the extent of the attenuation of the within-subject estimates toward the population estimates is not simply related to the distance between those two sets of estimates. Consider the two panels, labeled 330 and 337, at the top right of Fig. <a href="#fig:shrinkfit" data-reference-type="ref" data-reference="fig:shrinkfit">[fig:shrinkfit]</a>. The within-subject estimates for 337 are quite unlike the population estimates but the mixed-model estimates are very close to these within-subject estimates. That is, the solid line and the dashed line in that panel are nearly coincident and both are a considerable distance from the dot-dashed line. For subject 330, however, the dashed line is more-or-less an average of the solid line and the dot-dashed line, even though the solid and dot-dashed lines are not nearly as far apart as they are for subject 337.</p>
<p>The difference between these two cases is that the within-subject estimates for 337 are very well determined. Even though this subject had an unusually large intercept and slope, the overall pattern of the responses is very close to a straight line. In contrast, the overall pattern for 330 is not close to a straight line so the within-subject coefficients are not well determined. The multiple <span class="math inline">\(R^2\)</span> for the solid line in the 337 panel is <span class="math inline">\(93.3\%\)</span> but in the 330 panel it is only <span class="math inline">\(15.8\%\)</span>. The mixed model can pull the predictions in the 330 panel, where the data are quite noisy, closer to the population line without increasing the residual sum of squares substantially. When the within-subject coefficients are precisely estimated, as in the 337 panel, very little shrinkage takes place.</p>
<p>We see from Fig. <a href="#fig:shrinkfit" data-reference-type="ref" data-reference="fig:shrinkfit">[fig:shrinkfit]</a> that the mixed-effects model smooths out the between-subject differences in the predictions by bringing them closer to a common set of predictions, but not at the expense of dramatically increasing the sum of squared residuals. That is, the predictions are determined so as to balance fidelity to the data, measured by the residual sum of squares, with simplicity of the model. The simplest model would use the same prediction in each panel (the dot-dashed line) and the most complex model, based on linear relationships in each panel, would correspond to the solid lines. The dashed lines are between these two extremes. We will return to this view of the predictions from mixed models balancing complexity versus fidelity in , where we make the mathematical nature of this balance explicit.</p>
<p>We should also examine the prediction intervals on the random effects (Fig. <a href="#fig:caterpillar" data-reference-type="ref" data-reference="fig:caterpillar">[fig:caterpillar]</a>) where we see that many prediction intervals overlap zero but there are several that do not. In this plot the subjects are ordered from bottom to top according to increasing conditional mode of the random effect for <code>(1|subj)</code>. The resulting pattern in the conditional modes of the random effect for <code>(0+days|subj)</code> reinforces our conclusion that the model <code>m12</code>, which does not allow for correlation of the random effects for <code>(1|subj)</code> and <code>(0+days|subj)</code>, is suitable.</p>


<div class="bottom-nav">
    <p id="nav-prev" style="text-align: left;">
        <a class="menu-level-2" href="/assess-prec-param"><b>3.3</b> Assessing the Precisio..</a> <kbd>←</kbd>
        <span id="nav-next" style="float: right;">
            <kbd>→</kbd> <a class="menu-level-2" href="/chapter-summary"><b>3.5</b> Chapter Summary</a>
        </span>
    </p>
</div>


<div class="license">
    <br/>
  <br/>
  <a href="http://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a>
    Phillip Alday, Dave Kleinschmidt, Reinhold Kliegl, Douglas Bates
</div>
</div>
</div>
</body>
</html>