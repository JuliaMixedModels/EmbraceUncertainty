<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.52">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Appendix A — Working with data tables – Embrace Uncertainty</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./linalg.html" rel="next">
<link href="./references.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./datatables.html">Appendices</a></li><li class="breadcrumb-item"><a href="./datatables.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Working with data tables</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Embrace Uncertainty</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">A simple, linear, mixed-effects model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./multiple.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Models with multiple random-effects terms</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./longitudinal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Models for longitudinal data</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./largescaledesigned.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">A large-scale designed experiment</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./largescaleobserved.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A large-scale observational study</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./glmmbernoulli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generalized linear mixed models for binary responses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datatables.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Working with data tables</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./linalg.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Linear algebra for linear models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aGHQ.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">GLMM log-likelihood</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-arrow-format-for-data-tables" id="toc-the-arrow-format-for-data-tables" class="nav-link active" data-scroll-target="#the-arrow-format-for-data-tables"><span class="header-section-number">A.1</span> The Arrow format for data tables</a></li>
  <li><a href="#sec-Tablesjl" id="toc-sec-Tablesjl" class="nav-link" data-scroll-target="#sec-Tablesjl"><span class="header-section-number">A.2</span> Tables.jl provides an “interface for tables”</a></li>
  <li><a href="#the-table-type-from-typedtables" id="toc-the-table-type-from-typedtables" class="nav-link" data-scroll-target="#the-table-type-from-typedtables"><span class="header-section-number">A.3</span> The Table type from TypedTables</a>
  <ul class="collapse">
  <li><a href="#accessing-columns-or-rows-in-a-table" id="toc-accessing-columns-or-rows-in-a-table" class="nav-link" data-scroll-target="#accessing-columns-or-rows-in-a-table"><span class="header-section-number">A.3.1</span> Accessing columns or rows in a Table</a></li>
  <li><a href="#a-trivial-example-done-several-ways" id="toc-a-trivial-example-done-several-ways" class="nav-link" data-scroll-target="#a-trivial-example-done-several-ways"><span class="header-section-number">A.3.2</span> A trivial example done several ways</a></li>
  <li><a href="#adding-or-removing-columns-from-a-table" id="toc-adding-or-removing-columns-from-a-table" class="nav-link" data-scroll-target="#adding-or-removing-columns-from-a-table"><span class="header-section-number">A.3.3</span> Adding or removing columns from a Table</a></li>
  </ul></li>
  <li><a href="#the-dataframes-package" id="toc-the-dataframes-package" class="nav-link" data-scroll-target="#the-dataframes-package"><span class="header-section-number">A.4</span> The DataFrames package</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./datatables.html">Appendices</a></li><li class="breadcrumb-item"><a href="./datatables.html"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Working with data tables</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-datatables" class="quarto-section-identifier">Appendix A — Working with data tables</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Load the packages to be used</p>
<div id="2" class="cell" data-execution_count="1">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">DataFrames</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">EmbraceUncertainty</span>: dataset</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">MixedModels</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Tables</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">TypedTables</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>A call to fit a mixed-effects model using the <code>MixedModels</code> package follows the <em>formula/data</em> specification that is common to many statistical model-fitting packages, especially those in <a href="https://r-project.org">R</a>. In Julia, model formulas and contrasts, which are used to produce model matrices from a formula/data specification, are implemented in the <a href="https://github.com/JuliaStats/StatsModels.jl">StatsModels.jl</a> package.</p>
<p>The <code>data</code> argument must be able to be expressed as a column-oriented <em>data table</em>, which, for these purposes, is a named, ordered collection of columns, each of which is a homogeneous (i.e.&nbsp;all the elements have the same type) vector and all of which have the same length.</p>
<p>Implementations of column-oriented data tables are ubiquitous in data science, where they are often called <em>data frames</em>. These include the <em>data.frame</em> type in <a href="https://R-Project.org">R</a> and the <a href="https://cloud.cran.org/package=data.table">data.table</a> package for <a href="https://R-Project.org">R</a>, and the <code>DataFrame</code> class in the <a href="https://pandas.pydata.org">pandas</a> package for <a href="https://python.org">Python</a> and, as a separate implementation, in the <a href="https://pola.rs">polars</a> package for <a href="https://python.org">Python</a> and <a href="https://rustlang.org">Rust</a>.</p>
<section id="the-arrow-format-for-data-tables" class="level2" data-number="A.1">
<h2 data-number="A.1" class="anchored" data-anchor-id="the-arrow-format-for-data-tables"><span class="header-section-number">A.1</span> The Arrow format for data tables</h2>
<p>An increasing popular representation of data frames is as <a href="https://arrow.apache.org">Arrow</a> tables. <a href="https://pola.rs">Polars</a> uses the Arrow format internally as does the <a href="https://duckdb.org">DuckDB</a> database. Recently it was announced that the 2.0 release of <a href="https://pandas.pydata.org">pandas</a> will allow for Arrow tables.</p>
<p>Arrow specifies a language-independent tabular memory format that provides many desirable properties, such as provision for missing data and compact representation of categorical data vectors, for data science. The memory format also defines a file format for storing and exchanging data tables. Because the memory format is essentially the same as the file format, Arrow files can be <a href="https://en.wikipedia.org/wiki/Memory-mapped_file">memory-mapped</a> providing very fast read speeds.</p>
<p>Furthermore, the Arrow Project provides a reference implementation of the Arrow format and tools for manipulating data in that format as a C++ library, which is used by implementations in several other languages, including C, C#, Go, Java, JavaScript, MATLAB, Python, R, and Ruby. The Julia implementation in <a href="https://github.com/apache/arrow-julia">Arrow.jl</a> does not call functions in the C++ library. Instead it implements the format in Julia code in such a way that Arrow vectors behave like native Julia vectors. That is, Arrow vectors are a subtype of <code>AbstractVector</code>. A similar approach is taken in the implementations of the Arrow format for the <a href="https://rustlang.org">Rust</a> language.</p>
<p>The data sets in the <code>MixedModels</code> package and the auxiliary data sets used in this book are stored in the Arrow file format and retrieved as <code>Arrow.Table</code>s. There are many examples throughout this book of loading such data sets.</p>
<div id="4" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>contra <span class="op">=</span> <span class="fu">dataset</span>(<span class="op">:</span>contra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Arrow.Table with 1934 rows, 5 columns, and schema:
 :dist   String
 :urban  String
 :livch  String
 :age    Float64
 :use    String</code></pre>
</div>
</div>
<p>Often, for ease of access and for display, we convert the Arrow table to a <code>Table</code>, which, contrary to convention, is a type defined in <a href="https://github.com/JuliaData/TypedTables.jl">TypedTables.jl</a> and not in <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a>.</p>
<p>Before going into detail about the properties and use of the <code>Table</code> type, let us first discuss the role of <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a>.</p>
</section>
<section id="sec-Tablesjl" class="level2" data-number="A.2">
<h2 data-number="A.2" class="anchored" data-anchor-id="sec-Tablesjl"><span class="header-section-number">A.2</span> Tables.jl provides an “interface for tables”</h2>
<p>An important characteristic of any system for working with data tables is whether the table is stored in memory column-wise or row-wise.</p>
<p>As described above, most implementations of data frames for data science store the data column-wise.</p>
<p>In <em>relational database management systems</em> (RDBMS), such as <a href="https://postgresql.org">PostgreSQL</a>, <a href="https://sqlite.org">SQLite</a>, and a multitude of commercial systems, a data table, called a <em>relation</em>, is typically stored row-wise. Such systems typically use <a href="https://en.wikipedia.org/wiki/SQL">SQL</a>, the <em>structured query language</em>, to define and access the data in tables, which is why that acronym appears in many of the names. There are exceptions to the row-wise rule, such as <a href="https://duckdb.org">DuckDB</a>, an SQL-based RDBMS, that, as mentioned above, represents relations as Arrow tables.</p>
<p>Many external representations of data tables, such as in comma-separated-value (CSV) files, are row-oriented. Furthermore, it is often convenient to generate a data table a row at a time.</p>
<p>Thus it becomes convenient to have a “clearing house” that can accept either row tables or column tables and provided the desired form to a downstream package, such as <a href="https://github.com/JuliaStats/StatsModels.jl">StatsModels.jl</a>. <a href="https://github.com/JuliaData/Tables.jl">Tables.jl</a> does exactly this. It is not an implementation of data tables itself, but rather it defines “an interface for tables in Julia”, allowing a row-oriented table to be accessed column-wise and vice-versa.</p>
<p>It defines a prototype column-oriented table, <code>Tables.ColumnTable</code>, as a <a href="https://docs.julialang.org/en/v1/base/base/#Core.NamedTuple">NamedTuple</a> of vectors.</p>
<div id="6" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>Tables.ColumnTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>NamedTuple{names, T} where {N, names, T&lt;:Tuple{Vararg{AbstractVector, N}}}</code></pre>
</div>
</div>
<p>and a prototype row-oriented table as a vector of <code>NamedTuple</code>s.</p>
<div id="8" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>Tables.RowTable</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>AbstractVector{T} where T&lt;:NamedTuple (alias for AbstractArray{T, 1} where T&lt;:NamedTuple)</code></pre>
</div>
</div>
<p>The actual implementation of a row-table or column-table type may be different from these prototypes but it must provide access methods as if it were one of these types. <code>Tables.jl</code> provides the “glue” to treat a particular data table type as if it were row-oriented, by calling <code>Tables.rows</code> or <code>Tables.rowtable</code> on it, or column-oriented, by calling <code>Tables.columntable</code> on it.</p>
</section>
<section id="the-table-type-from-typedtables" class="level2" data-number="A.3">
<h2 data-number="A.3" class="anchored" data-anchor-id="the-table-type-from-typedtables"><span class="header-section-number">A.3</span> The Table type from TypedTables</h2>
<p><a href="https://github.com/JuliaData/TypedTables.jl">TypedTables.jl</a> is a lightweight package (about 1500 lines of source code) that provides a concrete implementation of column-tables, called simply <code>Table</code>, as a <code>NamedTuple</code> of vectors.</p>
<p>A <code>Table</code> that is constructed from another type of column-table, such as an <code>Arrow.Table</code> or a <code>DataFrame</code> or an explicit <code>NamedTuple</code> of vectors, is simply a wrapper around the original table’s contents. On the other hand, constructing a <code>Table</code> from a row table first creates a <code>ColumnTable</code>, then wraps it.</p>
<div id="10" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>contratbl <span class="op">=</span> <span class="fu">Table</span>(contra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 1934 rows:
      dist  urban  livch  age     use
    ┌────────────────────────────────
 1  │ D01   Y      3+     18.44   N
 2  │ D01   Y      0      -5.56   N
 3  │ D01   Y      2      1.44    N
 4  │ D01   Y      3+     8.44    N
 5  │ D01   Y      0      -13.56  N
 6  │ D01   Y      0      -11.56  N
 7  │ D01   Y      3+     18.44   N
 8  │ D01   Y      3+     -3.56   N
 9  │ D01   Y      1      -5.56   N
 10 │ D01   Y      3+     1.44    N
 11 │ D01   Y      0      -11.56  Y
 12 │ D01   Y      0      -2.56   N
 13 │ D01   Y      1      -4.56   N
 14 │ D01   Y      3+     5.44    N
 15 │ D01   Y      3+     -0.56   N
 16 │ D01   Y      3+     4.44    Y
 17 │ D01   Y      0      -5.56   N
 ⋮  │  ⋮      ⋮      ⋮      ⋮      ⋮</code></pre>
</div>
</div>
<div id="12" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>(contratbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table{@NamedTuple{dist::String, urban::String, livch::String, age::Float64, use::String}, 1, @NamedTuple{dist::Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}, urban::Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}, livch::Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}, age::Arrow.DictEncoded{Float64, Int8, Arrow.Primitive{Float64, Vector{Float64}}}, use::Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}}}</code></pre>
</div>
</div>
<p>(The output from that expression is a very long string. You need to scroll to the right over the output to see all the output.)</p>
<p>This type of table is said to be “strongly typed”, meaning that the data type itself contains a wealth of detail about the exact form of the table, allowing the Julia compiler to generate efficient code for operations on the table. That is the positive aspect of being so specific about the names of the columns and the details of the type of data in each column. However, it also means that this mechanism is not suitable for tables with a large number, say hundreds or thousands, of columns, which can overburden the compiler.</p>
<section id="accessing-columns-or-rows-in-a-table" class="level3" data-number="A.3.1">
<h3 data-number="A.3.1" class="anchored" data-anchor-id="accessing-columns-or-rows-in-a-table"><span class="header-section-number">A.3.1</span> Accessing columns or rows in a Table</h3>
<p>The methods for accessing columns or rows in a <code>Table</code> are simple.</p>
<p>A column is accessed by its name as a “property”, either using the <code>getproperty</code> extractor function or, more commonly, with the dot (<code>.</code>) operator, returning a vector.</p>
<div id="14" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>contratbl.urban</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1934-element Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}:
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 ⋮
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"</code></pre>
</div>
</div>
<p>The column names are <a href="https://docs.julialang.org/en/v1/base/base/#Core.Symbol">Symbols</a>, not strings, usually typed as a <code>:</code> followed by the name, as shown in</p>
<div id="16" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">columnnames</span>(contratbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(:dist, :urban, :livch, :age, :use)</code></pre>
</div>
</div>
<p>The <code>:</code> form for creating the Symbol requires that the column name be a valid variable name in Julia. If, for example, a column name contains a blank, the <code>:</code> form must be replaced by an expression like <code>var"&lt;name&gt;"</code>, which invokes what is called a “string macro”.</p>
<div id="18" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>contratbl.var<span class="st">"urban"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>1934-element Arrow.DictEncoded{String, Int8, Arrow.List{String, Int32, Vector{UInt8}}}:
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 "Y"
 ⋮
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"
 "N"</code></pre>
</div>
</div>
<p>A row is accessed by its index, either using the <code>getindex</code> function or, more commonly, with the index in square brackets, returning a <code>NamedTuple</code> for a singleton index or another <code>Table</code> for a vector-valued index.</p>
<div id="20" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>contratbl[<span class="fl">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>(dist = "D01", urban = "Y", livch = "3+", age = 18.44, use = "N")</code></pre>
</div>
</div>
<div id="22" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>contratbl[<span class="fl">2</span><span class="op">:</span><span class="fl">5</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D01   Y      0      -5.56   N
 2 │ D01   Y      2      1.44    N
 3 │ D01   Y      3+     8.44    N
 4 │ D01   Y      0      -13.56  N</code></pre>
</div>
</div>
<p>(Notice that the row numbers are not part of the table. Extracting a subset of the rows produces a table with row numbers starting at one, regardless of what the original row numbers were.)</p>
<p>But there is much more to the indexing than simply extracting a subset of rows - it provides an iterator interface to <code>Table</code>.</p>
</section>
<section id="a-trivial-example-done-several-ways" class="level3" data-number="A.3.2">
<h3 data-number="A.3.2" class="anchored" data-anchor-id="a-trivial-example-done-several-ways"><span class="header-section-number">A.3.2</span> A trivial example done several ways</h3>
<p>Suppose we wish to select the rows from district <code>D49</code> as a table. We could create a Boolean vector and use it to index into <code>contratbl</code></p>
<div id="24" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>contratbl[contratbl.dist <span class="op">.==</span> <span class="st">"D49"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D49   N      0      -12.56  N
 2 │ D49   N      0      -9.56   N
 3 │ D49   N      0      -10.56  N
 4 │ D49   N      3+     2.44    N</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
.== is the vectorized form of the equality comparison, ==
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>When comparing a vector, like <code>contratbl.dist</code> to a single string or number, like <code>"D47"</code> we must “vectorize” the operation, which is done here using <a href="https://docs.julialang.org/en/v1/manual/functions/#man-vectorized">dot vectorization</a></p>
</div>
</div>
</div>
<p>Or we could <code>filter</code> the rows of the table by applying a function to each row to determine if the <code>dist</code> field has the value <code>"D49"</code>.</p>
<div id="26" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">isD49dist</span>(row) <span class="op">=</span> row.dist <span class="op">==</span> <span class="st">"D49"</span> <span class="co"># a 'one-liner' function definition</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(isD49dist, contratbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D49   N      0      -12.56  N
 2 │ D49   N      0      -9.56   N
 3 │ D49   N      0      -10.56  N
 4 │ D49   N      3+     2.44    N</code></pre>
</div>
</div>
<p>Or we could write the filter function as an anonymous function</p>
<div id="28" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(r <span class="op">-&gt;</span> r.dist <span class="op">==</span> <span class="st">"D49"</span>, contratbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D49   N      0      -12.56  N
 2 │ D49   N      0      -9.56   N
 3 │ D49   N      0      -10.56  N
 4 │ D49   N      3+     2.44    N</code></pre>
</div>
</div>
<p>Or we could write the filter function as the composition of a function that extracts the first value from the row, which is the <code>dist</code> value, and a function that compares that value to <code>"D49"</code>.</p>
<div id="30" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(<span class="op">==</span>(<span class="st">"D49"</span>) <span class="op">∘</span> first, contratbl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D49   N      0      -12.56  N
 2 │ D49   N      0      -9.56   N
 3 │ D49   N      0      -10.56  N
 4 │ D49   N      3+     2.44    N</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The function composition operator
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The function composition operator, <code>∘</code>, typed as <code>\circ&lt;tab&gt;</code>, is described in <a href="https://docs.julialang.org/en/v1/manual/functions/#Function-composition-and-piping">this manual section</a>,</p>
</div>
</div>
</div>
<p>Or we could write a <a href="https://docs.julialang.org/en/v1/manual/arrays/#Generator-Expressions">generator expression</a></p>
<div id="32" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Table</span>(r <span class="cf">for</span> r <span class="kw">in</span> contratbl <span class="cf">if</span> r.dist <span class="op">==</span> <span class="st">"D49"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 4 rows:
     dist  urban  livch  age     use
   ┌────────────────────────────────
 1 │ D49   N      0      -12.56  N
 2 │ D49   N      0      -9.56   N
 3 │ D49   N      0      -10.56  N
 4 │ D49   N      3+     2.44    N</code></pre>
</div>
</div>
<p>The point is that all of these variations are from the base Julia language and simply rely on the fact that <code>contratbl</code> can be treated as an <em>iterator</em> over the rows of the table.</p>
<p>As shown in the last code block, the process of iterating over the rows of a <code>Table</code> can be applied in reverse, constructing a <code>Table</code> from an iterator or a generator expression that returns <code>NamedTuple</code>s. In <a href="glmmbernoulli.html" class="quarto-xref"><span>Chapter 6</span></a> a <code>newdata</code> table is constructed from the Cartesian product of vectors of covariates as the <code>newdata</code> table.</p>
<div id="34" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="op">=</span> <span class="fu">Table</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  (; age<span class="op">=</span>a, ch<span class="op">=</span>c, urban<span class="op">=</span>u)  <span class="co"># NamedTuple from iterator product</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> a <span class="kw">in</span> <span class="op">-</span><span class="fl">10</span><span class="op">:</span><span class="fl">3</span><span class="op">:</span><span class="fl">20</span>, c <span class="kw">in</span> [<span class="cn">false</span>, <span class="cn">true</span>], u <span class="kw">in</span> [<span class="st">"N"</span>, <span class="st">"Y"</span>]</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 3 columns and 44 rows:
      age  ch     urban
    ┌──────────────────
 1  │ -10  false  N
 2  │ -7   false  N
 3  │ -4   false  N
 4  │ -1   false  N
 5  │ 2    false  N
 6  │ 5    false  N
 7  │ 8    false  N
 8  │ 11   false  N
 9  │ 14   false  N
 10 │ 17   false  N
 11 │ 20   false  N
 12 │ -10  true   N
 13 │ -7   true   N
 14 │ -4   true   N
 15 │ -1   true   N
 16 │ 2    true   N
 17 │ 5    true   N
 ⋮  │  ⋮     ⋮      ⋮</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Expression for creating a NamedTuple
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>In general a <code>Tuple</code> is written as a comma-separated set of values within parentheses.</p>
<div id="36" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">typeof</span>((<span class="fl">1</span>, <span class="cn">true</span>, <span class="ch">'R'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Tuple{Int64, Bool, Char}</code></pre>
</div>
</div>
<p>This looks like the arguments to a function call without the function name, which is not accidental - internally the structure is exactly that of the arguments to a function call. Just as we can optionally separate the positional arguments from the named arguments with <code>;</code> in a function call, we can indicate that we are generating a <code>NamedTuple</code> by prefacing the named values with <code>;</code> as shown in this example.</p>
<p>In this expression the <code>;</code> is not necessary but there is another form where we just give the name of the variable, like simply specifying <code>contrasts</code> in the function call like <code>fit(MixedModel, form, data; contrasts)</code>, where the <code>;</code> indicates that the following arguments are named arguments so that <code>contrasts</code> by itself is equivalent to <code>contrasts=contrasts</code> specifying both the name and the value.</p>
<p>Thus the <code>newdata</code> table could be constructed as</p>
<div id="38" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="op">=</span> <span class="fu">Table</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  (; age, ch, urban) <span class="cf">for</span> age <span class="kw">in</span> <span class="op">-</span><span class="fl">10</span><span class="op">:</span><span class="fl">3</span><span class="op">:</span><span class="fl">20</span>, ch <span class="kw">in</span> [<span class="cn">false</span>, <span class="cn">true</span>],</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  urban <span class="kw">in</span> [<span class="st">"N"</span>, <span class="st">"Y"</span>]</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 3 columns and 44 rows:
      age  ch     urban
    ┌──────────────────
 1  │ -10  false  N
 2  │ -7   false  N
 3  │ -4   false  N
 4  │ -1   false  N
 5  │ 2    false  N
 6  │ 5    false  N
 7  │ 8    false  N
 8  │ 11   false  N
 9  │ 14   false  N
 10 │ 17   false  N
 11 │ 20   false  N
 12 │ -10  true   N
 13 │ -7   true   N
 14 │ -4   true   N
 15 │ -1   true   N
 16 │ 2    true   N
 17 │ 5    true   N
 ⋮  │  ⋮     ⋮      ⋮</code></pre>
</div>
</div>
</div>
</div>
</div>
<p><a href="https://github.com/JuliaData/TypedTables.jl">TypedTables.jl</a> leverages the power of the base Julia language and its implementation of concepts such as iterators to provide data manipulation without needing to re-implement each concept from scratch.</p>
</section>
<section id="adding-or-removing-columns-from-a-table" class="level3" data-number="A.3.3">
<h3 data-number="A.3.3" class="anchored" data-anchor-id="adding-or-removing-columns-from-a-table"><span class="header-section-number">A.3.3</span> Adding or removing columns from a Table</h3>
<p>Because <code>TypeTables.Table</code> wraps a <code>NamedTuple</code> of vectors, which is an immutable type, a <code>Table</code>’s column names and types cannot be changed. However, it is easy and fast to create a new <code>Table</code> from an existing <code>Table</code>. (The reason this operation is fast is because it does not copy the contents of the vectors in the table, it just creates a new <code>NamedTuple</code> and wrapper referencing the existing contents.)</p>
<p>During the creation of a new <code>Table</code> columns can be added or removed.</p>
<p>For example, in <a href="glmmbernoulli.html" class="quarto-xref"><span>Chapter 6</span></a> we added a Boolean column, <code>ch</code>, indicating if <code>livch</code> is not <code>"0"</code>, to the <code>contra</code> table using an expression like</p>
<div id="40" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>contratbl <span class="op">=</span> <span class="fu">Table</span>(contratbl; ch<span class="op">=</span>contratbl.livch <span class="op">.==</span> <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 6 columns and 1934 rows:
      dist  urban  livch  age     use  ch
    ┌───────────────────────────────────────
 1  │ D01   Y      3+     18.44   N    false
 2  │ D01   Y      0      -5.56   N    true
 3  │ D01   Y      2      1.44    N    false
 4  │ D01   Y      3+     8.44    N    false
 5  │ D01   Y      0      -13.56  N    true
 6  │ D01   Y      0      -11.56  N    true
 7  │ D01   Y      3+     18.44   N    false
 8  │ D01   Y      3+     -3.56   N    false
 9  │ D01   Y      1      -5.56   N    false
 10 │ D01   Y      3+     1.44    N    false
 11 │ D01   Y      0      -11.56  Y    true
 12 │ D01   Y      0      -2.56   N    true
 13 │ D01   Y      1      -4.56   N    false
 14 │ D01   Y      3+     5.44    N    false
 15 │ D01   Y      3+     -0.56   N    false
 16 │ D01   Y      3+     4.44    Y    false
 17 │ D01   Y      0      -5.56   N    true
 ⋮  │  ⋮      ⋮      ⋮      ⋮      ⋮     ⋮</code></pre>
</div>
</div>
<p>If later we decide that we can do without this column we can drop it using <code>getproperties</code> whose second argument should be a <code>Tuple</code> of <code>Symbol</code>s of the names of the columns to retain.</p>
<div id="42" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>contratbl <span class="op">=</span> <span class="fu">Table</span>(</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">getproperties</span>(contratbl, (<span class="op">:</span>dist, <span class="op">:</span>urban, <span class="op">:</span>livch, <span class="op">:</span>age, <span class="op">:</span>use)),</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<pre><code>Table with 5 columns and 1934 rows:
      dist  urban  livch  age     use
    ┌────────────────────────────────
 1  │ D01   Y      3+     18.44   N
 2  │ D01   Y      0      -5.56   N
 3  │ D01   Y      2      1.44    N
 4  │ D01   Y      3+     8.44    N
 5  │ D01   Y      0      -13.56  N
 6  │ D01   Y      0      -11.56  N
 7  │ D01   Y      3+     18.44   N
 8  │ D01   Y      3+     -3.56   N
 9  │ D01   Y      1      -5.56   N
 10 │ D01   Y      3+     1.44    N
 11 │ D01   Y      0      -11.56  Y
 12 │ D01   Y      0      -2.56   N
 13 │ D01   Y      1      -4.56   N
 14 │ D01   Y      3+     5.44    N
 15 │ D01   Y      3+     -0.56   N
 16 │ D01   Y      3+     4.44    Y
 17 │ D01   Y      0      -5.56   N
 ⋮  │  ⋮      ⋮      ⋮      ⋮      ⋮</code></pre>
</div>
</div>
</section>
</section>
<section id="the-dataframes-package" class="level2" data-number="A.4">
<h2 data-number="A.4" class="anchored" data-anchor-id="the-dataframes-package"><span class="header-section-number">A.4</span> The DataFrames package</h2>
<p>The <a href="https://github.com/JuliaData">JuliaData</a> organization manages the development of several packages related to data science and data management, including <a href="https://github.com/JuliaData/DataFrames.jl">DataFrames.jl</a>, a comprehensive system for working with column-oriented data tables in Julia. <span class="citation" data-cites="Kaminski2023">Kamiński (<a href="references.html#ref-Kaminski2023" role="doc-biblioref">2023</a>)</span>, written by the primary author of that package, provides an in-depth introduction to data science facilities, in particular the <code>DataFrames</code> package, in Julia.</p>
<p>This package is particularly well-suited to more advanced data manipulation such as the <code>split-apply-combine</code> strategy <span class="citation" data-cites="Wickham2011">(<a href="references.html#ref-Wickham2011" role="doc-biblioref">Wickham, 2011</a>)</span> and “joins” of data tables.</p>
<p><span class="citation" data-cites="JSSv107i04">Bouchet-Valat &amp; Kamiński (<a href="references.html#ref-JSSv107i04" role="doc-biblioref">2023</a>)</span> compares the performance of DataFrames.jl to other data frame implementations in R and Python.</p>
<p><em>This page was rendered from git revision <a href="https://github.com/JuliaMixedModels/EmbraceUncertainty/tree/9709cae
">9709cae
</a>.</em></p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list" style="display: none">
<div id="ref-JSSv107i04" class="csl-entry" role="listitem">
Bouchet-Valat, M., &amp; Kamiński, B. (2023). DataFrames.jl: Flexible and fast tabular data in <span>J</span>ulia. <em>Journal of Statistical Software</em>, <em>107</em>(4), 1–32. <a href="https://doi.org/10.18637/jss.v107.i04">https://doi.org/10.18637/jss.v107.i04</a>
</div>
<div id="ref-Kaminski2023" class="csl-entry" role="listitem">
Kamiński, B. (2023). <em>Julia for data analysis</em>. Manning.
</div>
<div id="ref-Wickham2011" class="csl-entry" role="listitem">
Wickham, H. (2011). The split-apply-combine strategy for data analysis. <em>Journal of Statistical Software</em>, <em>40</em>(1), 1–29. <a href="https://doi.org/10.18637/jss.v040.i01">https://doi.org/10.18637/jss.v040.i01</a>
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./references.html" class="pagination-link" aria-label="References">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">References</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./linalg.html" class="pagination-link" aria-label="Linear algebra for linear models">
        <span class="nav-page-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Linear algebra for linear models</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>